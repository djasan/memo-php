Les tableaux sont des structures capables de conserver en m√©moire plusieurs √©l√©ments. Et c'est ensuite gr√¢ce aux boucles que nous allons pouvoir :

    Parcourir les diff√©rentes recettes.

    Les afficher √† l'aide du langage HTML.

Nous reviendrons sur les tableaux en d√©tail dans le chapitre suivant, c'est l'un des √©l√©ments les plus utiles de PHP et je n'ai pas souvenir d'une seule de mes applications qui n'ait pas eu besoin de tableau.

√Ä la fin de ce chapitre, non seulement vous saurez parcourir une liste d'√©l√©ments, mais vous aurez √©galement commenc√© √† construire pour de bon votre application.
Utilisez un tableau pour lister des √©l√©ments

Reprenons notre projet l√† o√π nous l'avions laiss√© au chapitre pr√©c√©dent.

Nous avons :

    des utilisateurs ;

    des recettes ;

    et peut-√™tre des commentaires.

Avec les connaissances que vous avez pour le moment, voici comment vous pourriez d√©finir deux utilisateurs :

<?php


// Premier utilisateur

$userName1 = 'Micka√´l Andrieu';

$userEmail1 = 'mickael.andrieu@exemple.com';

$userPassword1 = 'S3cr3t';

$userAge1 = 34;


// Deuxi√®me utilisatrice

$userName2 = 'Laur√®ne Castor';

$userEmail2 = 'laurene.castor@exemple.com';

$userPassword2 = 'P4ssW0rD';

$userAge2 = 28;


// ... et ainsi de suite pour les autres utilisateurs.

Pour afficher ces utilisateurs (ou m√™me des recettes), je vais devoir cr√©er des variables pour chacun des √©l√©ments qui constituent mes objets ?

Non, heureusement !

En PHP, il existe un type de structure appel√©e "tableau". Elle permet de g√©rer des objets ayant plusieurs propri√©t√©s qui ont besoin d'√™tre rassembl√©es entre elles.

Par exemple, voici un premier tableau :

<?php


$user1 = ['Micka√´l Andrieu', 'email', 'S3cr3t', 34];


echo $user1[0]; // "Micka√´l Andrieu"

echo $user1[1]; // "email"

echo $user1[3]; // 34

Notez pour le moment que :

    un tableau se d√©clare entre crochets : [ ] ;

    il poss√®de des indices : 0, 1, 2, ‚Ä¶ ;

    on peut acc√©der √† un √©l√©ment du tableau √† partir de ces cl√©s.

Les indices d'un tableau commencent √† 0, et pas √† 1.

Mais la puissance des tableaux ne s'arr√™te pas l√† !

Vous pouvez construire des tableaux de tableaux :

<?php


$mickael = ['Micka√´l Andrieu', 'mickael.andrieu@exemple.com', 'S3cr3t', 34];

$mathieu = ['Mathieu Nebra', 'mathieu.nebra@exemple.com', 'devine', 33];

$laurene = ['Laur√®ne Castor', 'laurene.castor@exemple.com', 'P4ssw0rD', 28];


$users = [$mickael, $mathieu, $laurene];


echo $users[1][1]; // "mathieu.nebra@exemple.com"

Maintenant, comment boucler sur cette liste d'utilisateurs (ou de recettes) pour afficher les recettes ?

C'est exactement ce que nous allons voir maintenant !
Utilisez une boucle simple :  while

Attendez mais on n'a m√™me pas vu ce qu'√©tait une boucle, √† quoi √ßa sert ?

C'est une structure qui fonctionne sur le m√™me principe qu'une condition  if‚Ä¶ else  .

D'ailleurs, vous allez voir qu'il y a beaucoup de similitudes avec le chapitre sur les conditions.

Concr√®tement, une boucle permet de r√©p√©ter des instructions plusieurs fois. En clair : c'est un gain de temps, c'est tr√®s pratique, et bien souvent indispensable.

On peut, si vous voulez, pr√©senter le principe avec le sch√©ma suivant :
Le sch√©ma montre le fonctionnement d'une boucle : les instructions sont ex√©cut√©es dans l'ordre, de haut en bas. √Ä la fin, on retourne √† la premi√®re et on recommence.
Principe de fonctionnement d'une boucle

Voil√† ce qui se passe dans une boucle :

    Comme d'habitude, les instructions sont d'abord ex√©cut√©es dans l'ordre, de haut en bas.

    √Ä la fin des instructions, on retourne √† la premi√®re.

    On recommence √† lire les instructions dans l'ordre.

    Et on retourne √† la premi√®re, etc.

Le seul hic dans ce sch√©ma, c'est que √ßa ne s'arr√™te jamais ! Les instructions seraient r√©ex√©cut√©es √† l'infini !
C'est pour cela que, quel que soit le type de boucle, while  ou for, il faut indiquer une condition.

Tant que la condition est remplie, les instructions sont r√©ex√©cut√©es.

D√®s que la condition n'est plus remplie, on sort enfin de la boucle. Ouf !

Voici comment faire avec une boucle simple :  while  . 

<?php

while ($isValid) {

    // instructions √† ex√©cuter dans la boucle

}

?>

while  peut se traduire par ¬´ tant que ¬ª.

Ici, on demande √† PHP :

    TANT QUE $isValid est vrai, ex√©cuter ces instructions.

Les instructions qui sont r√©p√©t√©es en boucle se trouvent entre les accolades {  et  }  .

Mais bon, l√† je ne vous apprends rien, vous commencez √† avoir l'habitude de voir des accolades partout. ü§ì

Et voil√†, il n'y a gu√®re plus de choses √† savoir. Cependant, je vais quand m√™me vous montrer un ou deux exemples d'utilisation de boucles, pour que vous voyiez √† quoi √ßa peut servir.

Pour notre premier exemple, on va supposer que vous avez √©t√© puni et que vous devez recopier 100 fois :

    ¬´ Je ne dois pas regarder les mouches voler quand j'apprends le PHP ¬ª.

Avant, il fallait prendre son mal en patience et √ßa prenait des heures‚Ä¶ Avec PHP, on va faire √ßa en un clin d'≈ìil !

Regardez ce code :

<?php

$lines = 1;


while ($lines <= 100) {

    echo 'Je ne dois pas regarder les mouches voler quand j\'apprends le PHP.<br />';

    $lines++; // $lines = $lines + 1

}

?>

Ce qui affiche... un grand nombre de lignes :
Capture d'√©cran des lignes affich√©es gr√¢ce √† une boucle PHP. On peut lire la phrase
Des lignes affich√©es gr√¢ce √† une boucle PHP

La boucle pose la condition :

    TANT QUE $lines est inf√©rieur ou √©gal √† 100.

Dans cette boucle, il y a deux instructions :

    echo permet d'afficher du texte en PHP. √Ä noter qu'il y a une balise HTML <br />  √† la fin : cela permet d'aller √† la ligne (vu que vous connaissez le HTML, √ßa n'a rien de surprenant : chaque phrase sera √©crite sur une seule ligne).

    $lines++; est une fa√ßon plus courte d'ajouter 1 √† la variable. On appelle cela l'incr√©mentation (ce nom barbare signifie tout simplement que l'on a ajout√© 1 √† la variable).

Chaque fois qu'on fait une boucle, la valeur de la variable augmente : 1, 2, 3, 4‚Ä¶ 99, 100‚Ä¶

D√®s que la variable atteint 101, on arr√™te la boucle.

Et voil√†, on a √©crit 100 lignes en un clin d'≈ìil.

Si la punition avait √©t√© plus grosse, pas de probl√®me ! Il aurait suffi de changer la condition, par exemple : mettre ¬´ TANT QUE c'est inf√©rieur ou √©gal √† 500 ¬ª pour l'√©crire 500 fois.

Il faut toujours s'assurer que la condition sera fausse au moins une fois. Si elle ne l'est jamais, alors la boucle s'ex√©cutera √† l'infini !

PHP refuse normalement de travailler plus d'une quinzaine de secondes. Il s'arr√™tera tout seul s'il voit que son travail dure trop longtemps, et affichera un message d'erreur.

Nous venons donc de voir comment afficher une phrase plusieurs centaines de fois sans effort.

Mais est-ce vraiment utile ? On n'a pas besoin de faire √ßa sur un site web, si ?

Pas vraiment, mais nous apprenons ici des techniques de base que l'on va pouvoir r√©utiliser plus tard dans ce cours. Imaginez √† la fin que ce syst√®me de boucle va vous permettre de demander √† PHP d'afficher d'une seule traite tous les messages de votre forum. Bien s√ªr, il vous faudra d'autres connaissances pour y parvenir, mais sans les boucles vous n'auriez rien pu faire !

Je vous demande pour le moment de pratiquer et de comprendre comment √ßa marche.

Bon, un autre exemple pour le plaisir ?

On peut √©crire de la m√™me mani√®re une centaine de lignes, mais chacune peut √™tre diff√©rente : on n'est pas oblig√© d'√©crire la m√™me chose √† chaque fois.

Cet exemple devrait vous montrer que la valeur de la variable augmente √† chaque passage dans la boucle :

<?php

$lines = 1;


while ($lines <= 100)

{

    echo 'Ceci est la ligne n¬∞' . $lines . '<br />';

    $lines++;

}

?>


<!--


Ceci est la ligne n¬∞1

Ceci est la ligne n¬∞2

...

-->

Voil√†, c'est tout b√™te, et cet exemple ressemble beaucoup au pr√©c√©dent.

La particularit√©, l√†, c'est qu'on affiche √† chaque fois la valeur de  $lines  .

Cela vous permet de voir que sa valeur augmente petit √† petit.

Pour information, l'astuce que je vous avais donn√©e dans le chapitre sur les conditions marche aussi ici :

    Vous pouvez fermer la balise PHP  ?>  .

    √âcrire du texte en HTML.

    Puis rouvrir la balise PHP  <?php  .

Cela vous √©vite d'utiliser une ou plusieurs instructions echo au milieu.

On aura l'occasion d'utiliser cette astuce de nombreuses fois dans la suite du cours.

D'accord, mais pour un tableau de tableaux : comment on fait alors ?

On va l'aborder en d√©tail dans le chapitre suivant ; en attendant, voici le code fonctionnel :

<?php


$lines = 3; // nombre d'utilisateurs dans le tableau

$counter = 0;


while ($counter < $lines) {

    echo $users[$counter][0] . ' ' . $users[$counter][1] . '<br />';

    $counter++; // Ne surtout pas oublier la condition de sortie !

}

Pour le r√©sultat suivant :
On voit la liste des utilisateurs et leurs emails avec une boucle while : Micka√´l Andrieu, Mathieu Nebra et Laur√®ne Castor
Liste des utilisateurs avec une boucle while
D√©couvrez une boucle plus complexe :  for

Mais non, n'ayez pas peur, voyons.
Il ne vous arrivera rien de mal : ici le mot ¬´ complexe ¬ª ne veut pas dire ¬´ compliqu√© ¬ª.

for est un autre type de boucle qui a une forme un peu plus condens√©e et plus commode √† √©crire. Elle est donc fr√©quemment utilis√©e.

Cependant, sachez que for  et while  donnent le m√™me r√©sultat et servent √† la m√™me chose : r√©p√©ter des instructions en boucle.

L'une peut para√Ætre plus adapt√©e que l'autre dans certains cas ; cela d√©pend aussi des go√ªts.

Alors, comment √ßa marche un for ?

√áa ressemble beaucoup au while mais c'est la premi√®re ligne qui est un peu particuli√®re.

Pour voir la diff√©rence avec le while , reprenons l'exemple pr√©c√©dent, cette fois avec un for :

<?php

for ($lines = 0; $lines <= 2; $lines++)

{

    echo $users[$lines][0] . ' ' . $users[$lines][1] . '<br />';

}

?>

Que de choses dans une m√™me ligne !

Bon, vous vous en doutez : je vais vous analyser la ligne du for uniquement (le reste n'a pas chang√©).

Apr√®s le mot for  , il y a des parenth√®ses qui contiennent trois √©l√©ments, s√©par√©s par des points-virgules ;  :

    Le premier sert √† l'initialisation. C'est la valeur que l'on donne au d√©part √† la variable (ici, elle vaut 0).

    Le second, c'est la condition. Comme pour le while : tant que la condition est remplie, la boucle est r√©ex√©cut√©e. D√®s que la condition ne l'est plus, on en sort.

    Enfin, le troisi√®me c'est l'incr√©mentation. Cela permet d'ajouter 1 √† la variable √† chaque tour de boucle.

Les deux derniers codes donnent donc exactement le m√™me r√©sultat :

    le for fait la m√™me chose que le  while  ;

    ‚Ä¶ mais il rassemble sur une seule ligne tout ce qu'il faut savoir sur le fonctionnement de la boucle.

Comment savoir lequel choisir ? while  ou for ?

while  est plus simple et plus flexible : on peut faire tous les types de boucles avec, mais on peut oublier de faire certaines √©tapes, comme l'incr√©mentation de la variable.

for  est bien adapt√© quand on doit compter le nombre de fois que l'on r√©p√®te les instructions, et il permet de ne pas oublier de faire l'incr√©mentation pour augmenter la valeur de la variable !

Si vous h√©sitez entre les deux, il suffit simplement de vous poser la question suivante : ¬´ Est-ce que je sais d'avance combien de fois je veux que mes instructions soient r√©p√©t√©es ? ¬ª.

Si la r√©ponse est oui, alors la boucle for  est tout indiqu√©e.

Sinon, alors il vaut mieux utiliser la boucle while .
Affichez des recettes

Reprenons ce que nous avions dit sur les recettes.

Une recette, c'est :

    un titre ;

    un auteur ;

    un statut activ√© ;

    et des instructions (la recette √† suivre).

Le code de votre application √† ce stade pourrait √™tre le suivant (avec des recettes d'exemple, bien s√ªr) :

<?php


// D√©claration du tableau des recettes

$recipes = [

    ['Cassoulet','[...]','mickael.andrieu@exemple.com',true,],

    ['Couscous','[...]','mickael.andrieu@exemple.com',false,],

];


?>


<!DOCTYPE html>

<html>

<head>

    <title>Affichage des recettes</title>

</head>

<body>

    <ul>

        <?php for ($lines = 0; $lines <= 1; $lines++): ?>

            <li><?php echo $recipes[$lines][0] . ' (' . $recipes[$lines][2] . ')'; ?></li>

        <?php endfor; ?>

    </ul>

</body>

</html>

Pour le rendu suivant :
Affichage de nos recettes : version 0 !
Affichage de nos recettes : version 0 !

Ah ! En HTML, on peut utiliser la boucle  for  comme une boucle  if  : je reconnais l'astuce avec  endif;  et  endfor;  , c'est bien √ßa ?

Tout √† fait, comme vous pouvez le voir, c'est assez pratique !

On peut combiner les boucles et les conditions ? Au final, on a affich√© aussi la recette "Couscous" alors que le statut d'affichage est √† "faux"‚Ä¶ 

Oui, mais nous verrons cela dans le prochain chapitre !
En r√©sum√©

    Les boucles demandent √† PHP de r√©p√©ter des instructions plusieurs fois.

    Les deux principaux types de boucles sont :

        while : √† utiliser de pr√©f√©rence lorsqu'on ne sait pas par avance combien de fois la boucle doit √™tre r√©p√©t√©e ;

        for  : √† utiliser lorsqu'on veut r√©p√©ter des instructions un nombre pr√©cis de fois.

    L'incr√©mentation est une technique qui consiste √† ajouter 1 √† la valeur d'une variable. La d√©cr√©mentation retire au contraire 1 √† cette variable. On trouve souvent des incr√©mentations au sein de boucles for  .
